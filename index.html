<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <title>DMZ Key map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
    <link rel="stylesheet" href="./styles.css" />
</head>

<body>
    <!-- <div>
        <h3>Al-Bagra Barrack key</h6>
        <p><b>Description:</b> Used to unlock barracks of the al-bagra group in the fortess</p>
        <img class="popupImg" src="./Location for the Al-Bagra Barrack KEY! Warzone 2! MW2 DMZ! 0-1 screenshot.png">
    </div> -->

    </div>
    <div id="map"></div>
    <div>
        Click on the map to get precise position.
    </div>
    <script>
        let mapSettings = {
            crs: L.CRS.Simple,
            minZoom: -0.5,
            maxZoom: 4,
            zoomDelta: 0.5,
            zoomSnap: 0,
            wheelPxPerZoomLevel: 75,
        }
        let bounds = [[0, 0], [1200, 1200]];
        let attribution = { attribution: '<a href="https://github.com/3ncy/DMZmap">Support and Contribute on GitHub</a>' }

        let map = L.map('map', mapSettings);
        let image = L.imageOverlay('warzone-2-al-mazrah-map-cropped.jpg', bounds, attribution).addTo(map);
        map.fitBounds(bounds);
        // map.setView([611, 595], 0); //set view to center around the surface layer

        let popup = L.popup();
        function onMapClick(e) {
            console.log("You clicked the map at " + e.latlng);
            popup
                .setLatLng(e.latlng)
                .setContent(/*"You clicked the map at " + */e.latlng.toString())
                .openOn(map);
        }
        map.on('click', onMapClick);

        //NOTE: in case this becomes map for more than keys, repurpuse this. There's prolly gonna be only the "Desc" variable and it will include all the needed HTML for formatting.
        //TODO: read these from external file
        let popupName = "Al-Bagra Barrack key";
        let popupDesc = "Used to unlock barracks of the al-bagra group in the fortess";
        let popupBehindTheLock = "Two rooms get unlocked by one use of the key. There is one big crate with valuable loot and a weapon in each.";
        let popupImgPaths = ["al-bagra_barrack_key-location.png", "al-bagra_barrack_key-map.png"]
        //TODO: read all images until there's like empty line in the file or sth

        let markerHTML = `<div><h3>${popupName}</h3>
            <p><b>Description: </b>${popupDesc}</p>
            <p><b>Behind the lock: </b>${popupBehindTheLock}</p>`
        for (let path of popupImgPaths) {
            markerHTML += `<img class="popupImg" src="./images/${path}"></div>`;
        }

        let aa = L.latLng(73, 870);
        L.marker(aa).addTo(map).bindPopup(markerHTML);

        //TODO: create a bigger size of the image:
        //a big div that is opened when you click the smaller image and has set img src to the image. Then you can close it by either hitting ESC or sth like that 

    </script>
</body>

</html>